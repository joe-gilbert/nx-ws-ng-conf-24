# Nx Scalable Architecture Design

In this exercise we will learn how to create scalable architecture design using Nx. We will create multiple libraries of all types (feature, data-access, ui, util) and scopes (movies, shared).

Tasks:

- Create library for shared models
  - MovieModel (`apps/movies/src/app/movie/movie-model.ts`)
  - TMDBMovieGenreModel (`apps/movies/src/app/shared/model/movie-genre.model.ts`)
- Create library for shared utils for env-token to handle environment variables
- Create library for shared feature not-found-page (`apps/movies/src/app/not-found-page`)
- Create library for shared ui star-rating (`apps/movies/src/app/ui/pattern/start-rating`)
- Create library for movies ui movie-card (`apps/movies/src/app/movie/movie-card`)
- Create library for movies data-access that includes search-movie.service.ts (`apps/movies/src/app/movie/search-movie.service.ts`)
- Create library for movies feature movie search control (`apps/movies/src/app/movie/movie-search-control`)

- After creating all the libraries, make sure that the application is still working as expected.
- Run `nx graph` and see how the dependencies are connected between the libraries and the application.


<details>
  <summary>Solution</summary>

### Create library for shared utils for env-token to handle environment variables

```bash
npx nx generate @nx/angular:lib --name=util-env-token --directory=libs/shared --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/shared/util-env-token/src/lib/shared-util-env-token
```

- Move the `env-token.ts` file from `apps/movies/src/app/shared/util` to `libs/shared/util-env-token/src/lib`. 
- Export the `env-token.ts` file from `index.ts`.
- Replace all broken imports with the new path `shared/util-env-token`.

### Create library for shared feature not-found-page

```bash
npx nx generate @nx/angular:library --name=feature-not-found-page --directory=libs/shared --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/shared/feature-not-found-page/src/lib/shared-feature-not-found-page
```

- Move the `not-found-page` folder from `apps/movies/src/app` to `libs/shared/feature-not-found-page/src/lib`.
- Export the `not-found-page` folder from `index.ts`.
- Replace all broken imports with the new path `shared/feature-not-found-page`.

### Create library for shared models

```bash
npx nx generate @nx/angular:library --name=models --directory=libs/shared --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/shared/models/src/lib/shared-models
```

- Move the `movie-model.ts` (`apps/movies/src/app/movie/movie-model.ts`) and `movie-genre.model.ts` (`apps/movies/src/app/shared/model/movie-genre.model.ts`) files  to `libs/shared/models/src/lib`.
- Export the `movie-model.ts` and `movie-genre.model.ts` files from `index.ts`.
- Replace all broken imports with the new path `shared/models`.

### Create library for shared ui star-rating

```bash
npx nx generate @nx/angular:library --name=ui-star-rating --directory=libs/shared --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/shared/ui-star-rating/src/lib/shared-ui-star-rating
```

- Move the `star-rating` folder from `apps/movies/src/app/ui/pattern` to `libs/shared/ui-star-rating/src/lib`.
- Export the `star-rating` folder from `index.ts`.
- Replace all broken imports with the new path `shared/ui-star-rating`.

### Create library for movies ui movie-card

```bash
npx nx generate @nx/angular:library --name=ui-movie-card --directory=libs/movies --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/movies/ui-movie-card/src/lib/movies-ui-movie-card
```

- Move the `movie-card` folder from `apps/movies/src/app/movie` to `libs/movies/ui-movie-card/src/lib`.
- Export the `movie-card` folder from `index.ts`.
- Replace all broken imports with the new path `movies/ui-movie-card`.

### Create library for movies data-access that includes search-movie.service.ts

```bash
npx nx generate @nx/angular:library --name=data-access-movies --directory=libs/movies --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/movies/data-access-movies/src/lib/movies-data-access-movies
```

- Move the `search-movie.service.ts` file from `apps/movies/src/app/movie` to `libs/movies/data-access-movies/src/lib`.
- Export the `search-movie.service.ts` file from `index.ts`.
- Replace all broken imports with the new path `movies/data-access-movies`.

### Create library for movies feature movie search control

```bash
npx nx generate @nx/angular:library --name=feature-movie-search-control --directory=libs/movies --no-interactive
```

- Remove the component and spec file that was generated by default

```bash
rm -rf libs/movies/feature-movie-search-control/src/lib/movies-feature-movie-search-control
```

- Move the `movie-search-control` folder from `apps/movies/src/app/movie` to `libs/movies/feature-movie-search-control/src/lib`.
- Export the `movie-search-control` folder from `index.ts`.
- Replace all broken imports with the new path `movies/feature-movie-search-control`.

</details>
